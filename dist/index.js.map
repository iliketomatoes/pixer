{"version":3,"file":null,"sources":["../lib/utils.js","../lib/index.js"],"sourcesContent":["// http://stackoverflow.com/a/24253254/1550955\nexport function colourGradientor(p, first_color, second_color) {\n    let w = p * 2 - 1;\n    let rgb_beginning = turnRgbIntoArray(first_color);\n    let rgb_end = turnRgbIntoArray(second_color);\n    let w1 = (w + 1) / 2.0;\n    let w2 = 1 - w1;\n    let rgb = [Math.round(rgb_beginning[0] * w1 + rgb_end[0] * w2),\n        Math.round(rgb_beginning[1] * w1 + rgb_end[1] * w2),\n        Math.round(rgb_beginning[2] * w1 + rgb_end[2] * w2)];\n    return turnArrayIntoRgb(rgb);\n}\n;\nexport function getBgColor(el) {\n    return window.getComputedStyle(el, null).getPropertyValue('background-color');\n}\n// http://stackoverflow.com/a/1183906/1550955\nexport function turnRgbIntoArray(rgb) {\n    const numberPattern = /\\d+/g;\n    return rgb.match(numberPattern).map(n => parseInt(n));\n}\nexport function turnArrayIntoRgb(rgbArr) {\n    return `rgb(${rgbArr[0]}, ${rgbArr[1]}, ${rgbArr[2]})`;\n}\nexport function getGradientWeight(lineNumber, totalLines) {\n    const startingEdge = lineNumber - 1;\n    const endingEdge = lineNumber;\n    const startingEdgeRatio = startingEdge / totalLines;\n    const endingEdgeRatio = endingEdge / totalLines;\n    let deltaRatio = endingEdgeRatio - startingEdgeRatio;\n    return {\n        even: startingEdgeRatio + (deltaRatio * 0.33),\n        odd: startingEdgeRatio + (deltaRatio * 0.66)\n    };\n}\n","import { colourGradientor, getBgColor, getGradientWeight } from './utils';\nvar Pixer;\n(function (Pixer) {\n    let idCursor = 0;\n    let IDs = [];\n    let defaults = {\n        stripes: 4\n    };\n    function init() {\n        let targets = document.querySelectorAll('canvas[data-pixer]');\n        let options;\n        for (let el of targets) {\n            if (el.tagName.toLowerCase() === 'canvas') {\n                // If elements are already initialized\n                if (el.hasAttribute('data-pixer-id'))\n                    continue;\n                options = el.getAttribute('data-pixer');\n                options = options != '' ? JSON.parse(options) : {};\n                // Reset data-pixer attribute\n                el.setAttribute('data-pixer', '');\n                setupCanvas(el, options);\n            }\n            else {\n                console.error('Pixer.js: target must be a canvas element');\n            }\n        }\n    }\n    Pixer.init = init;\n    function setupCanvas(canvas, options) {\n        let settings = Object.assign(defaults, options);\n        let canvasId = 'pixer_' + idCursor;\n        canvas.setAttribute('data-pixer-id', canvasId);\n        // Stringify settings so we can put them into the HTML data attribute\n        canvas.setAttribute('data-pixer-opts', JSON.stringify(settings));\n        // Icrease the cursor\n        idCursor++;\n        // Store the id\n        IDs.push(canvasId);\n        reflow(canvas);\n    }\n    function reflow(canvas) {\n        let canvasSize = setSize(canvas);\n        clearCanvas(canvas, canvasSize);\n        paint(canvas, canvasSize, defaults);\n    }\n    function clearCanvas(canvas, canvasSize) {\n        const ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n    function paint(canvas, canvasSize, options) {\n        let colors = setBgColor(canvas, canvasSize, options);\n        setSquares(canvas, canvasSize, colors, options);\n    }\n    function setBgColor(canvas, size, options) {\n        let colors = {\n            previousRGB: getBgColor(canvas.previousElementSibling),\n            nextRGB: getBgColor(canvas.nextElementSibling)\n        };\n        const ctx = canvas.getContext(\"2d\");\n        ctx.fillStyle = colors.previousRGB;\n        ctx.fillRect(0, 0, size.width, size.height / 2);\n        ctx.fillStyle = colors.nextRGB;\n        ctx.fillRect(0, size.height / 2, size.width, size.height / 2);\n        return colors;\n    }\n    function setSize(canvas) {\n        let canvasSize = getSize(canvas);\n        canvas.setAttribute('width', canvasSize.width.toString());\n        canvas.setAttribute('height', canvasSize.height.toString());\n        return canvasSize;\n    }\n    function getSize(canvas) {\n        let width = canvas.clientWidth;\n        let height = canvas.clientHeight;\n        return {\n            width: width,\n            height: height\n        };\n    }\n    function getSettings(options) {\n        Object.assign(this.defaults, options);\n    }\n    function setSquares(canvas, size, colors, options) {\n        const stripes = options.stripes;\n        const squareDiagonal = stripes > 2 ? (size.height / (stripes - 1)) : (size.height / stripes);\n        const squareSide = squareDiagonal / Math.SQRT2;\n        const squaresPerStripe = Math.round(size.width / squareDiagonal);\n        const ctx = canvas.getContext(\"2d\");\n        for (let j = 0; j < stripes; j++) {\n            let startingY = (squareDiagonal / 2) * j;\n            let gradientWeight = getGradientWeight(j + 1, stripes);\n            let color1 = colourGradientor(gradientWeight.odd, colors.nextRGB, colors.previousRGB);\n            let color2 = colourGradientor(gradientWeight.even, colors.nextRGB, colors.previousRGB);\n            for (let i = 0; i <= squaresPerStripe; i++) {\n                let startingX = (squareDiagonal / 2 * ((i * 2) + 1)) - ((j % 2) * (squareDiagonal / 2));\n                ctx.save();\n                if (i % 2 === 0) {\n                    if (j % 2 === 0) {\n                        ctx.fillStyle = color1;\n                    }\n                    else {\n                        ctx.fillStyle = color2;\n                    }\n                }\n                else {\n                    if (j % 2 === 0) {\n                        ctx.fillStyle = color2;\n                    }\n                    else {\n                        ctx.fillStyle = color1;\n                    }\n                }\n                ctx.translate(startingX, startingY);\n                ctx.rotate(Math.PI / 4);\n                ctx.fillRect(0, 0, squareSide, squareSide);\n                ctx.restore();\n            }\n        }\n    }\n    class API {\n        constructor() { }\n        static get Instance() {\n            return this._instance || (this._instance = new this());\n        }\n    }\n    Pixer.API = API;\n})(Pixer || (Pixer = {}));\nfunction pixer() {\n    Pixer.init();\n    return Pixer.API;\n}\nexport default pixer;\n"],"names":["colourGradientor","p","first_color","second_color","w","rgb_beginning","turnRgbIntoArray","rgb_end","w1","w2","rgb","Math","round","turnArrayIntoRgb","getBgColor","el","window","getComputedStyle","getPropertyValue","numberPattern","match","map","parseInt","n","rgbArr","getGradientWeight","lineNumber","totalLines","startingEdge","endingEdge","startingEdgeRatio","endingEdgeRatio","deltaRatio","Pixer","idCursor","IDs","defaults","init","targets","document","querySelectorAll","options","tagName","toLowerCase","hasAttribute","getAttribute","JSON","parse","setAttribute","error","setupCanvas","canvas","settings","Object","assign","canvasId","stringify","push","reflow","canvasSize","setSize","clearCanvas","ctx","getContext","clearRect","width","height","paint","colors","setBgColor","size","previousElementSibling","nextElementSibling","fillStyle","previousRGB","fillRect","nextRGB","getSize","toString","clientWidth","clientHeight","getSettings","setSquares","stripes","squareDiagonal","squareSide","SQRT2","squaresPerStripe","j","startingY","gradientWeight","color1","odd","color2","even","i","startingX","save","translate","rotate","PI","restore","API","_instance","pixer"],"mappings":"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"}